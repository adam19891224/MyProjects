<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.boss.dao.tags.mapper.TagsMapper" >

    <resultMap id="TagsInfoMap" type="com.boss.dao.tags.pojo.TagsInfo" extends="BaseResultMap" >
        <association property="articleCounts" column="TAG_ID" select="selectArticleCountsByTagID"/>
    </resultMap>

    <select id="selectTagsByPage" resultMap="TagsInfoMap" parameterType="com.boss.foundation.view.Page">
        SELECT
            tt.TAG_SID,
            tt.TAG_ID,
            tt.TAG_NAME
        FROM
          tb_tags tt

        <if test="pagination != null and pagination == true">
            limit #{pageNum}, #{pageSize}
        </if>

    </select>

    <select id="selectTagsCountByPage" resultType="java.lang.Integer" parameterType="com.boss.foundation.view.Page">
        SELECT
          COUNT(*)
        FROM
          tb_tags tt
    </select>

    <select id="selectArticleCountsByTagID" resultType="java.lang.Integer">
        SELECT
          COUNT(*)
        FROM
          tb_article_tags tat
        WHERE
          tat.TAG_ID = #{TAG_ID}
    </select>

    <delete id="deleteTagsBySid" parameterType="java.lang.Integer">
        DELETE
            tb_tags,
            tb_article_tags
        FROM
            tb_tags
        INNER JOIN
            tb_article_tags
        ON
            tb_tags.TAG_ID = tb_article_tags.TAG_ID
        WHERE
            tb_tags.TAG_SID = #{id}
    </delete>


</mapper>